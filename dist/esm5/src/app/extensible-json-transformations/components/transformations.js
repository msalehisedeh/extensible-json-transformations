import { Inquirer } from './inquirer';
var Styler = /** @class */ (function () {
    function Styler(transformations) {
        this.inquirer = new Inquirer();
        this.transformations = transformations;
        this.inquirer.initTemplates(this.transformations.templates);
    }
    Styler.prototype.changeRootNode = function (node) {
        this.inquirer.setRootNode(node);
    };
    Styler.prototype.transform = function () {
        var result = [];
        var template = this.inquirer.templateForName(this.transformations.rootTemplate);
        if (template) {
            var attrs = Object.keys(template.style);
            var nodeList = this.inquirer.templateNodes(template, this.inquirer.nodeList(null));
            for (var i = 0; i < nodeList.length; i++) {
                var currentNode = nodeList[i];
                var resultingNode = {};
                for (var j = 0; j < attrs.length; j++) {
                    var attr = attrs[j];
                    resultingNode[attr] = this.inquirer.invoke(template.style[attr], currentNode);
                }
                ;
                result.push(resultingNode);
            }
            ;
        }
        if (this.transformations.onResult && this.transformations.onResult.length) {
            var functions = this.inquirer.toQueryOperation(this.transformations.onResult);
            result = this.inquirer.invoke(functions, result);
        }
        return result;
    };
    return Styler;
}());
export { Styler };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNmb3JtYXRpb25zLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHNlZGVoL2V4dGVuc2libGUtanNvbi10cmFuc2Zvcm1hdGlvbnMvIiwic291cmNlcyI6WyJzcmMvYXBwL2V4dGVuc2libGUtanNvbi10cmFuc2Zvcm1hdGlvbnMvY29tcG9uZW50cy90cmFuc2Zvcm1hdGlvbnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFVLFFBQVEsRUFBWSxNQUFNLFlBQVksQ0FBQztBQWF4RDtJQUtJLGdCQUFZLGVBQStCO1FBQ3ZDLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxRQUFRLEVBQUUsQ0FBQztRQUMvQixJQUFJLENBQUMsZUFBZSxHQUFHLGVBQWUsQ0FBQztRQUN2QyxJQUFJLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ2hFLENBQUM7SUFFTSwrQkFBYyxHQUFyQixVQUFzQixJQUFRO1FBQzFCLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFFTSwwQkFBUyxHQUFoQjtRQUNJLElBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQztRQUNoQixJQUFNLFFBQVEsR0FBWSxJQUFJLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBRTNGLElBQUksUUFBUSxFQUFFO1lBQ1YsSUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDMUMsSUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFFckYsS0FBSSxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7Z0JBQ3JDLElBQU0sV0FBVyxHQUFHLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDaEMsSUFBTSxhQUFhLEdBQUcsRUFBRSxDQUFDO2dCQUN6QixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtvQkFDbkMsSUFBTSxJQUFJLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUN0QixhQUFhLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxXQUFXLENBQUMsQ0FBQztpQkFDakY7Z0JBQUEsQ0FBQztnQkFDRixNQUFNLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO2FBQzlCO1lBQUEsQ0FBQztTQUNMO1FBQ0QsSUFBRyxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUU7WUFDdEUsSUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ2hGLE1BQU0sR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLENBQUM7U0FDcEQ7UUFDRCxPQUFPLE1BQU0sQ0FBQztJQUNsQixDQUFDO0lBQ0wsYUFBQztBQUFELENBQUMsQUF2Q0QsSUF1Q0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBKWFBhdGgsIElucXVpcmVyLCBUZW1wbGF0ZSB9IGZyb20gJy4vaW5xdWlyZXInO1xyXG4vKlxyXG4gKiB0b29sIHRvIGRpc3BsYXkgcmVzdWx0IG9mIGEgc2VhcmNoIG9uIHNldCBvZiBwb2ludHMgb2YgaW50ZXJlc3RzIG9uIG9iamVjdHMuXHJcbiAqL1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBUcmFuc2Zvcm1hdGlvbnMge1xyXG4gICAgbmFtZTogc3RyaW5nLFxyXG4gICAgaW1wb3J0VXJscz86c3RyaW5nW10sXHJcbiAgICByb290VGVtcGxhdGU6IHN0cmluZyxcclxuICAgIG9uUmVzdWx0Pzogc3RyaW5nLFxyXG4gICAgdGVtcGxhdGVzOiBUZW1wbGF0ZVtdXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBTdHlsZXIgIHtcclxuXHJcbiAgICBwcml2YXRlIHRyYW5zZm9ybWF0aW9uczogVHJhbnNmb3JtYXRpb25zO1xyXG4gICAgcHJpdmF0ZSBpbnF1aXJlcjpJbnF1aXJlcjtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcih0cmFuc2Zvcm1hdGlvbnM6VHJhbnNmb3JtYXRpb25zKSB7XHJcbiAgICAgICAgdGhpcy5pbnF1aXJlciA9IG5ldyBJbnF1aXJlcigpO1xyXG4gICAgICAgIHRoaXMudHJhbnNmb3JtYXRpb25zID0gdHJhbnNmb3JtYXRpb25zO1xyXG4gICAgICAgIHRoaXMuaW5xdWlyZXIuaW5pdFRlbXBsYXRlcyh0aGlzLnRyYW5zZm9ybWF0aW9ucy50ZW1wbGF0ZXMpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjaGFuZ2VSb290Tm9kZShub2RlOmFueSkge1xyXG4gICAgICAgIHRoaXMuaW5xdWlyZXIuc2V0Um9vdE5vZGUobm9kZSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHRyYW5zZm9ybSgpIHtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gW107XHJcbiAgICAgICAgY29uc3QgdGVtcGxhdGU6VGVtcGxhdGUgPSB0aGlzLmlucXVpcmVyLnRlbXBsYXRlRm9yTmFtZSh0aGlzLnRyYW5zZm9ybWF0aW9ucy5yb290VGVtcGxhdGUpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICh0ZW1wbGF0ZSkge1xyXG4gICAgICAgICAgICBjb25zdCBhdHRycyA9IE9iamVjdC5rZXlzKHRlbXBsYXRlLnN0eWxlKTtcclxuICAgICAgICAgICAgY29uc3Qgbm9kZUxpc3QgPSB0aGlzLmlucXVpcmVyLnRlbXBsYXRlTm9kZXModGVtcGxhdGUsIHRoaXMuaW5xdWlyZXIubm9kZUxpc3QobnVsbCkpO1xyXG4gICAgXHJcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBub2RlTGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudE5vZGUgPSBub2RlTGlzdFtpXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdGluZ05vZGUgPSB7fTtcclxuICAgICAgICAgICAgICAgIGZvciggbGV0IGogPSAwOyBqIDwgYXR0cnMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhdHRyID0gYXR0cnNbal07XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0aW5nTm9kZVthdHRyXSA9IHRoaXMuaW5xdWlyZXIuaW52b2tlKHRlbXBsYXRlLnN0eWxlW2F0dHJdLCBjdXJyZW50Tm9kZSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gocmVzdWx0aW5nTm9kZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHRoaXMudHJhbnNmb3JtYXRpb25zLm9uUmVzdWx0ICYmIHRoaXMudHJhbnNmb3JtYXRpb25zLm9uUmVzdWx0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjb25zdCBmdW5jdGlvbnMgPSB0aGlzLmlucXVpcmVyLnRvUXVlcnlPcGVyYXRpb24odGhpcy50cmFuc2Zvcm1hdGlvbnMub25SZXN1bHQpO1xyXG4gICAgICAgICAgICByZXN1bHQgPSB0aGlzLmlucXVpcmVyLmludm9rZShmdW5jdGlvbnMsIHJlc3VsdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbn1cclxuIl19